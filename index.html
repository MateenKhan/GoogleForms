<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://getbootstrap.com/docs/5.3/assets/css/docs.css"
      rel="stylesheet"
    />
    <title>Bootstrap Example</title>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"
      integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.14.1/jquery-ui.min.js"
      integrity="sha512-MSOo1aY+3pXCOCdGAYoBZ6YGI0aragoQsg1mKKBHXCYPIWxamwOE7Drh+N5CPgGI5SA9IEKJiPjdfqWFWmZtRA=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.14.1/themes/base/jquery-ui.min.css"
      integrity="sha512-TFee0335YRJoyiqz8hA8KV3P0tXa5CpRBSoM0Wnkn7JoJx1kaq1yXL/rb8YFpWXkMOjRcv5txv+C6UluttluCQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />

    <style>
      .input-error {
        outline: 1px solid red;
      }
      .ui-widget-header {
        background: #acd3ff;
      }

      .ui-widget-content .ui-state-default:hover {
        background: #acd3ff;
        border-radius: 2px;
      }

      .Customizations {
        height: 8rem;
      }

      #address {
        height: 7rem;
      }
      .input-group-text {
        font-weight: bold;
      }

      .main-title {
        text-align: center;
        margin-top: 20px;
      }
      nav-tabs .nav-item.show .nav-link,
      .nav-tabs .nav-link.active {
        color: var(--bs-green);
        font-size: larger;
        font-weight: 500;
      }
      .tab-content > .tab-pane {
        padding-top: 1rem;
      }
      .main-title {
        text-align: center;
        margin-top: 20px;
        font-family: cursive;
        font-style: italic;
        color: #833400;
      }
      body {
        background-color: #64acbb !important;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1 class="main-title">Cresent Crafts Hyderabad</h1>
      <ul class="nav nav-tabs menu-list" id="myTab" role="tablist">
        <li class="nav-item" role="presentation">
          <button
            class="nav-link active"
            id="home-tab"
            data-bs-toggle="tab"
            data-bs-target="#home-tab-pane"
            type="button"
            role="tab"
            aria-controls="home-tab-pane"
            aria-selected="true"
          >
            Form
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button
            class="nav-link"
            id="profile-tab"
            data-bs-toggle="tab"
            data-bs-target="#profile-tab-pane"
            type="button"
            role="tab"
            aria-controls="profile-tab-pane"
            aria-selected="false"
          >
            Calculator
          </button>
        </li>
      </ul>

      <div class="tab-content tabs-container" id="myTabContent">
        <div
          class="tab-pane fade show active form-tab"
          id="home-tab-pane"
          role="tabpanel"
          aria-labelledby="home-tab"
          tabindex="0"
        >
          <div class="form-container">
            <form id="create_orders_form" method="POST">
              <div class="row align-items-center">
                <div class="col-sm-12 col-lg-6">
                  <h2>Customer Details</h2>
                  <div class="input-group mb-3">
                    <label for="Name" class="input-group-text">Name</label>
                    <input
                      type="text"
                      class="form-control"
                      id="Name"
                      placeholder="Start typing..."
                      required="true"
                      name="Name"
                      aria-describedby="Name"
                    />
                  </div>

                  <div class="input-group mb-3">
                    <label for="Phone" class="input-group-text">Phone</label>
                    <input
                      name="Phone"
                      type="number"
                      class="form-control"
                      id="Phone"
                      required="true"
                      aria-describedby="Phone"
                    />
                  </div>

                  <div class="input-group mb-3">
                    <label for="Alternate" class="input-group-text"
                      >Alternate Phone</label
                    >
                    <input
                      name="Alternate"
                      type="number"
                      class="form-control"
                      id="Alternate"
                      required="true"
                      aria-describedby="Alternate"
                    />
                  </div>

                  <div class="input-group mb-3">
                    <label for="delivery_date" class="input-group-text"
                      >Delivery Date</label
                    >
                    <input
                      name="delivery_date"
                      type="text"
                      class="form-control"
                      id="delivery_date"
                      required="true"
                      aria-describedby="delivery_date"
                    />
                  </div>

                  <div class="input-group mb-3">
                    <label for="Address" class="input-group-text"
                      >Shipping Address</label
                    >
                    <textarea
                      name="Address"
                      class="form-control"
                      id="address"
                      required="true"
                      aria-describedby="Address"
                    ></textarea>
                  </div>
                </div>

                <div class="col-sm-12 col-lg-6">
                  <h2>Order Details</h2>

                  <div class="accordion">
                    <div class="accordion-item">
                      <h2 class="accordion-header">
                        <button
                          class="accordion-button"
                          type="button"
                          data-bs-toggle="collapse"
                          data-bs-target="#item1"
                          aria-expanded="true"
                        >
                          Item #<span class="item-number">1</span>
                        </button>
                      </h2>
                      <div id="item1" class="accordion-collapse collapse">
                        <div class="accordion-body">
                          <div class="mb-3">
                            <label for="Customizations" class="form-label"
                              >Customizations</label
                            >
                            <textarea
                              name="Customizations"
                              type="text"
                              class="form-control Customizations"
                              id="Customizations"
                              aria-describedby="Customizations"
                            ></textarea>
                            <div id="Customizations" class="form-text">
                              (name, date, size, colour, link, etc )
                            </div>
                          </div>

                          <div class="form-check form-switch">
                            <input
                              name="product_type"
                              class="form-check-input product_type"
                              type="checkbox"
                              role="switch"
                            />
                            <label class="form-check-label" for="product_type"
                              >Square</label
                            >
                          </div>

                          <div class="mb-3 round">
                            <label for="Diameter" class="form-label"
                              >Diameter</label
                            >
                            <input
                              name="Diameter"
                              type="number"
                              class="form-control i_diameter"
                              aria-describedby="Diameter"
                            />
                            <div class="form-text">Please enter in inches</div>
                          </div>

                          <div class="mb-3 square">
                            <div class="row">
                              <div class="col-5">
                                <label for="Length" class="form-label length"
                                  >Length</label
                                >
                                <input
                                  name="Length"
                                  type="number"
                                  class="form-control i_length"
                                  aria-describedby="Length"
                                />
                                <div class="form-text">
                                  Please Length in inches
                                </div>
                              </div>
                              <div class="col-2">
                                <br />
                                X
                              </div>
                              <div class="col-5">
                                <label for="Height" class="form-label height"
                                  >Height</label
                                >
                                <input
                                  name="Height"
                                  type="number"
                                  class="form-control i_height"
                                  aria-describedby="Height"
                                />
                                <div class="form-text">
                                  Please Length in inches
                                </div>
                              </div>
                            </div>
                          </div>

                          <div class="mb-3 coating">
                            <label for="O_Coating" class="form-label"
                              >Coating Thickness</label
                            >
                            <input
                              name="O_Coating"
                              type="number"
                              class="form-control i_Coating"
                              aria-describedby="O_Coating"
                            />
                            <div id="O_Coating" class="form-text">
                              Please enter in inches
                            </div>
                          </div>

                          <div class="input-group mb-3">
                            <button
                              class="btn btn-primary calculate_price"
                              type="button"
                            >
                              Calculate Price
                            </button>
                            <input
                              type="text"
                              class="form-control"
                              placeholder=" <== click this button"
                              aria-label="<== click this button"
                              aria-describedby="Calculate"
                            />
                            <span class="input-group-text">₹</span>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="pt-2 row align-items-center">
                    <div class="col-1"></div>
                    <button
                      type="button"
                      class="col-10 btn btn-primary btn-lg"
                      id="add_item"
                    >
                      Add Item
                    </button>
                    <div class="col-1"></div>
                  </div>
                </div>
              </div>

              <div class="action-items row align-items-center mt-2">
                <div class="col-1"></div>
                <button
                  type="submit"
                  class="col-4 btn btn-success btn-lg"
                  id="submit_btn"
                >
                  <span
                    class="loading spinner-border spinner-border-sm"
                    aria-hidden="true"
                  ></span>
                  <span class="loading" role="status">Loading...</span>
                  <span class="loaded">Submit</span>
                </button>
                <div class="col-2"></div>
                <button
                  type="button"
                  class="col-4 btn btn-primary btn-lg"
                  id="save_btn"
                >
                  <span
                    class="loading spinner-border spinner-border-sm"
                    aria-hidden="true"
                  ></span>
                  <span class="loading" role="status">Loading...</span>
                  <span class="loaded">Save</span>
                </button>
                <div class="col-1"></div>
              </div>
            </form>
          </div>
        </div>

        <div
          class="tab-pane fade calculator-tab"
          id="profile-tab-pane"
          role="tabpanel"
          aria-labelledby="profile-tab"
          tabindex="0"
        >
          <div class="row align-items-center">
            <div class="col-sm-12 col-lg-6 calculator-container-1">
              <form id="calculator_form">
                <h2>Resign Calculator</h2>

                <div class="input-group mb-3">
                  <label class="input-group-text" for="epoxy_type"
                    >Product Type</label
                  >
                  <select class="form-select" id="epoxy_type">
                    <option value="square" selected>Square</option>
                    <option value="round">Round</option>
                  </select>
                </div>

                <div class="input-group mb-3" id="round_div">
                  <span class="input-group-text" id="e_s_Diameter"
                    >Diameter - "</span
                  >
                  <input
                    type="number"
                    class="form-control"
                    placeholder="diameter"
                    aria-label="Diameter"
                    aria-describedby="Diameter"
                    id="e_Diameter"
                  />
                  <span class="input-group-text">"</span>
                </div>
                <div id="square_div">
                  <div class="input-group mb-3">
                    <span class="input-group-text" id="e_s_length"
                      >Length - "</span
                    >
                    <input
                      id="e_length"
                      type="number"
                      class="form-control"
                      placeholder="length"
                      aria-label="Length"
                      aria-describedby="length"
                    />
                    <span class="input-group-text">"</span>
                  </div>

                  <div class="input-group mb-3">
                    <span class="input-group-text" id="e_s_width"
                      >Height - "</span
                    >
                    <input
                      id="e_width"
                      type="number"
                      class="form-control"
                      placeholder="height"
                      aria-label="Height"
                      aria-describedby="height"
                    />
                    <span class="input-group-text">"</span>
                  </div>
                </div>

                <div class="input-group mb-3">
                  <span class="input-group-text" id="width"
                    >Coating Thickness - "</span
                  >
                  <input
                    id="e_coating"
                    type="number"
                    class="form-control"
                    placeholder="coating"
                    aria-label="Coating"
                    aria-describedby="coating"
                  />
                  <span class="input-group-text">"</span>
                </div>

                <div class="input-group mb-3">
                  <button class="btn btn-primary" type="submit" id="Calculate">
                    Calculate
                  </button>
                  <input
                    id="e_liters"
                    type="text"
                    readonly="true"
                    class="form-control"
                    placeholder="epoxy liters for your product"
                    aria-label="epoxy liters for your product"
                    aria-describedby="Calculate"
                  />
                  <span class="input-group-text">liters</span>
                </div>
              </form>
            </div>
            <div class="col-sm-12 col-lg-6 calculator-container-2">
              <form id="calculator_form_2">
                <h2>Price Calculator</h2>

                <div class="input-group mb-3">
                  <span class="input-group-text" id="width"
                    >Price Per Liter</span
                  >
                  <input
                    id="liter_price"
                    type="number"
                    class="form-control"
                    value="4000"
                  />
                </div>

                <div class="input-group mb-3">
                  <button
                    class="btn btn-primary"
                    type="submit"
                    id="price_calculate"
                  >
                    Calculate
                  </button>
                  <input
                    id="price"
                    type="text"
                    readonly="true"
                    class="form-control"
                    placeholder="estimate price"
                    aria-label="estimate price"
                    aria-describedby="Calculate"
                  />
                  <span class="input-group-text">₹</span>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
  <script>
    
    const submit_url =
          "https://script.google.com/macros/s/AKfycbwMVFZNwhuCXAHf_jz1o5gtxHWDfUYc2-RfJFYH_EkHw7Z_e2qz46aIJmEo1yz-2HUh/exec";

    $(document).ready(function () {
      loadDefauts();
      let product_type = $(".product_type");
      let epoxy_type = $("#epoxy_type");
      product_type.click(function () {
        $(this).parent().parent().find(".round").toggle();
        $(this).parent().parent().find(".square").toggle();
      });

      epoxy_type.change(function () {
        let val = $(this).val();
        if (val == "square") {
          $("#round_div").hide();
          $("#square_div").show();
        } else {
          $("#round_div").show();
          $("#square_div").hide();
        }
      });

      $("#delivery_date").datepicker({
        maxDate: "+1M",
        minDate: "+4D",
      });

      $("#Calculate").click(function () {
        calculateEpoxyResign();
      });

      $("#profile-tab").click(function () {
        $("#e_length").focus();
      });

      $("#add_item").click(function () {
        addItem();
      });

      $(".calculate_price").click(function () {
        O_calculatePrice($(this));
      });

    });

    window.addEventListener("load", function () {
      const form = document.getElementById("create_orders_form");
      const calculator_form = document.getElementById("calculator_form");
      const calculator_form_2 = document.getElementById("calculator_form_2");

      form.addEventListener("submit", function (e) {
        e.preventDefault();
        loading();
        const form_obj = new FormData(form);
        let product_type =
          $("#product_type").is("checked") ? "Square" : "Round";
        form_obj.append("product_type", product_type);
        let items_json = getAllItemsAsJson();
        form_obj.append("items_json", items_json);
        fetch(submit_url, {
          redirect: "follow",
          method: "POST",
          body: form_obj,
        }).then(() => {
          console.log("Form Created Successfully");
          location.reload();
        });
      });

      calculator_form.addEventListener("submit", function (e) {
        e.preventDefault();
        calculateEpoxyResign();
      });

      calculator_form_2.addEventListener("submit", function (e) {
        e.preventDefault();
        calculatePrice();
      });
    });

    function O_calculatePrice(ths) {
      let e_length = $("#e_length");
      let e_width = $("#e_width");
      let e_coating = $("#e_coating");
      let e_diameter = $("#e_Diameter");
      let isSquare = ths.parent().parent().find(".product_type").is(":checked");
      if (isSquare) {
        $("#epoxy_type").val("square");
      } else {
        $("#epoxy_type").val("round");
      }
      $("#epoxy_type").change();
      let length = ths.parent().parent().find(".i_length").val();
      let width = ths.parent().parent().find(".i_height").val();
      let coating = ths.parent().parent().find(".i_Coating").val();
      let diameter = ths.parent().parent().find(".i_diameter").val();
      e_length.val(length);
      e_width.val(width);
      e_coating.val(coating);
      e_diameter.val(diameter);
      $("#profile-tab").click();
      calculatePrice();
    }

    function addItem() {
      let lastItem = $(".accordion-item").last();
      let newItem = lastItem.clone(true);
      newItem.find("input, textarea").each(function () {
        $(this).val("");
      });
      let itemNumber = parseInt(newItem.find(".item-number").text());
      newItem.find("#item" + itemNumber).attr("id", "item" + (itemNumber + 1));
      newItem
        .find(".accordion-button")
        .attr("data-bs-target", "#item" + (itemNumber + 1));
      newItem.find(".item-number").text(itemNumber + 1);
      $(".accordion").append(newItem);
    }


    function getAllItemsAsJson(){
      let items = [];
      $(".accordion-item").each(function () {
        let item = {
          length: $(this).find(".i_length").val(),
          width: $(this).find(".i_height").val(),
          coating: $(this).find(".i_Coating").val(),
          diameter: $(this).find(".i_diameter").val(),
          customizations: $(this).find(".Customizations").val(),
        };
        items.push(item);
      });
      return JSON.stringify(items);
    }


    function calculatePrice() {
      calculateEpoxyResign();
      let price = 0;
      let epoxy_liters = $("#e_liters").val();
      let liter_price = $("#liter_price").val();
      price = epoxy_liters * liter_price;
      $("#price").val(price);
    }

    function calculateEpoxyResign() {
      let epoxy_type = $("#epoxy_type").val();
      let diameter = $("#e_Diameter").val();
      let length = $("#e_length").val();
      let width = $("#e_width").val();
      let coating = $("#e_coating").val();
      let epoxy_liters = 0;
      if (epoxy_type == "square") {
        epoxy_liters = (length * width * coating) / 62;
      } else {
        epoxy_liters = (3.14 * (diameter / 2) * (diameter / 2) * coating) / 62;
      }
      $("#e_liters").val(epoxy_liters);
    }

    function loadDefauts() {
      document.getElementById("create_orders_form").reset();
      $(".square, .loading, #round_div").hide();
      $(".round,.loaded").show();
      $("#submit_btn").removeAttr("disabled");
      $("#Name").focus();
    }

    function loading() {
      $("#submit_btn").attr("disabled", true);
      $(".loading").show();
      $(".loaded").hide();
    }
  </script>
</html>
